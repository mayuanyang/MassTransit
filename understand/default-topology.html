
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Topology Â· MassTransit</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.2">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-prism/prism.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="../build/gitbook.css">
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="additions-to-transport.html" />
    
    
    <link rel="prev" href="under-the-hood.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        <li class="header">Overview</li>
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="./">
            
                <a href="./">
            
                    
                    Understanding MassTransit
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="key-ideas.html">
            
                <a href="key-ideas.html">
            
                    
                    Key terminology
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="under-the-hood.html">
            
                <a href="under-the-hood.html">
            
                    
                    Under the hood
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.2.2.1" data-path="default-topology.html">
            
                <a href="default-topology.html">
            
                    
                    Topology
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="additions-to-transport.html">
            
                <a href="additions-to-transport.html">
            
                    
                    What we add to the transport
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="publishing.html">
            
                <a href="publishing.html">
            
                    
                    Publishing messages
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="sending.md">
            
                <span>
            
                    
                    Sending messages
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6" data-path="message-contracts.html">
            
                <a href="message-contracts.html">
            
                    
                    Message contract design
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7" data-path="perfcounters.html">
            
                <a href="perfcounters.html">
            
                    
                    Performance counters
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../quickstart.html">
            
                <a href="../quickstart.html">
            
                    
                    Quick Start!
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../learn/">
            
                <a href="../learn/">
            
                    
                    Learning MassTransit
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../learn/samples/">
            
                <a href="../learn/samples/">
            
                    
                    Samples
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1.1" data-path="../learn/samples/courier.html">
            
                <a href="../learn/samples/courier.html">
            
                    
                    Courier
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.2" data-path="../learn/samples/request-response.html">
            
                <a href="../learn/samples/request-response.html">
            
                    
                    Request/Response
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.3" data-path="../learn/samples/saga.html">
            
                <a href="../learn/samples/saga.html">
            
                    
                    Saga
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../learn/videos.html">
            
                <a href="../learn/videos.html">
            
                    
                    Videos
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../learn/courses.html">
            
                <a href="../learn/courses.html">
            
                    
                    Courses
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../learn/loving-the-community.html">
            
                <a href="../learn/loving-the-community.html">
            
                    
                    Loving the community
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../contributing/">
            
                <a href="../contributing/">
            
                    
                    Contributing
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Usage</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../introduction/">
            
                <a href="../introduction/">
            
                    
                    Installation
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.1" data-path="../introduction/prerequisites.html">
            
                <a href="../introduction/prerequisites.html">
            
                    
                    Prerequisites
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.2" data-path="../introduction/how-to-install.html">
            
                <a href="../introduction/how-to-install.html">
            
                    
                    How to install
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3" data-path="../introduction/getting-help.html">
            
                <a href="../introduction/getting-help.html">
            
                    
                    Getting help
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.4" data-path="../introduction/how-to-report-bugs.html">
            
                <a href="../introduction/how-to-report-bugs.html">
            
                    
                    How to report bugs
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="../usage/">
            
                <a href="../usage/">
            
                    
                    Using MassTransit
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.2.1" data-path="../usage/configuration.html">
            
                <a href="../usage/configuration.html">
            
                    
                    Configure MassTransit
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.2" data-path="../usage/transports.html">
            
                <a href="../usage/transports.html">
            
                    
                    Choose a transport
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.3" data-path="../usage/message-contracts.html">
            
                <a href="../usage/message-contracts.html">
            
                    
                    Create message contracts
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.4" data-path="../usage/message-consumers.html">
            
                <a href="../usage/message-consumers.html">
            
                    
                    Create message consumers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.5" data-path="../usage/producing-messages.html">
            
                <a href="../usage/producing-messages.html">
            
                    
                    Produce messages
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.6" data-path="../usage/correlation.html">
            
                <a href="../usage/correlation.html">
            
                    
                    Correlate messages
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.7" data-path="../usage/containers/">
            
                <a href="../usage/containers/">
            
                    
                    Use IoC container
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.2.7.1" data-path="../usage/containers/autofac.html">
            
                <a href="../usage/containers/autofac.html">
            
                    
                    Autofac
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.7.2" data-path="../usage/containers/ninject.html">
            
                <a href="../usage/containers/ninject.html">
            
                    
                    Ninject
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.7.3" data-path="../usage/containers/structuremap.html">
            
                <a href="../usage/containers/structuremap.html">
            
                    
                    StructureMap
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.7.4" data-path="../usage/containers/unity.html">
            
                <a href="../usage/containers/unity.html">
            
                    
                    Unity
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.7.5" data-path="../usage/containers/castlewindsor.html">
            
                <a href="../usage/containers/castlewindsor.html">
            
                    
                    Castle Windsor
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.2.8" data-path="../usage/request-response.html">
            
                <a href="../usage/request-response.html">
            
                    
                    Request/response
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.9" data-path="../usage/exceptions.html">
            
                <a href="../usage/exceptions.html">
            
                    
                    Handle exceptions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.10" data-path="../usage/retries.html">
            
                <a href="../usage/retries.html">
            
                    
                    Configure retries
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.11" data-path="../usage/scheduling/">
            
                <a href="../usage/scheduling/">
            
                    
                    Schedule messages
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.2.11.1" data-path="../usage/scheduling/scheduling-api.html">
            
                <a href="../usage/scheduling/scheduling-api.html">
            
                    
                    Scheduling API
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.11.2" data-path="../usage/scheduling/in-memory.html">
            
                <a href="../usage/scheduling/in-memory.html">
            
                    
                    In-memory scheduling
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.11.3" data-path="../usage/scheduling/azure-sb-scheduler.html">
            
                <a href="../usage/scheduling/azure-sb-scheduler.html">
            
                    
                    Azure Service Bus
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.11.4" data-path="../usage/scheduling/rabbitmq-delayed.html">
            
                <a href="../usage/scheduling/rabbitmq-delayed.html">
            
                    
                    RabbitMQ Delayed Exchange
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.11.5" data-path="../usage/scheduling/redeliver.html">
            
                <a href="../usage/scheduling/redeliver.html">
            
                    
                    Redelivering messages
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.2.12" data-path="../usage/observers.html">
            
                <a href="../usage/observers.html">
            
                    
                    Observe messages
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.13" data-path="../usage/lifecycle-observers.html">
            
                <a href="../usage/lifecycle-observers.html">
            
                    
                    Observe lifecycle
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.14" data-path="../usage/connect-endpoint.html">
            
                <a href="../usage/connect-endpoint.html">
            
                    
                    Connect endpoints
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.15" data-path="../usage/logging.html">
            
                <a href="../usage/logging.html">
            
                    
                    Logging
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Advanced</li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="../advanced/sagas/">
            
                <a href="../advanced/sagas/">
            
                    
                    Sagas
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1.1" data-path="../advanced/sagas/automatonymous.html">
            
                <a href="../advanced/sagas/automatonymous.html">
            
                    
                    Automatonymous
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.2" data-path="../advanced/sagas/persistence.html">
            
                <a href="../advanced/sagas/persistence.html">
            
                    
                    Persistence
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="../advanced/courier/">
            
                <a href="../advanced/courier/">
            
                    
                    Courier
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.2.1" data-path="../advanced/courier/activities.html">
            
                <a href="../advanced/courier/activities.html">
            
                    
                    Activities
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.2" data-path="../advanced/courier/builder.html">
            
                <a href="../advanced/courier/builder.html">
            
                    
                    Builder
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.3" data-path="../advanced/courier/execute.html">
            
                <a href="../advanced/courier/execute.html">
            
                    
                    Execution
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.4" data-path="../advanced/courier/events.html">
            
                <a href="../advanced/courier/events.html">
            
                    
                    Events
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.5" data-path="../advanced/courier/subscriptions.html">
            
                <a href="../advanced/courier/subscriptions.html">
            
                    
                    Subscriptions
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="../advanced/middleware/">
            
                <a href="../advanced/middleware/">
            
                    
                    Middleware
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.3.1" data-path="../advanced/middleware/circuit-breaker.html">
            
                <a href="../advanced/middleware/circuit-breaker.html">
            
                    
                    Circuit breaker
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3.2" data-path="../advanced/middleware/rate-limiter.html">
            
                <a href="../advanced/middleware/rate-limiter.html">
            
                    
                    Rate limiter
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3.3" data-path="../advanced/middleware/latest.html">
            
                <a href="../advanced/middleware/latest.html">
            
                    
                    Latest
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3.4" data-path="../advanced/middleware/custom.html">
            
                <a href="../advanced/middleware/custom.html">
            
                    
                    Custom
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="../advanced/audit/">
            
                <a href="../advanced/audit/">
            
                    
                    Audit
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.5" data-path="../advanced/turnout/">
            
                <a href="../advanced/turnout/">
            
                    
                    Turnout
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.6" data-path="../advanced/versioning.html">
            
                <a href="../advanced/versioning.html">
            
                    
                    Versioning
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.7" data-path="../advanced/transactions.html">
            
                <a href="../advanced/transactions.html">
            
                    
                    Transactions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.8" data-path="../advanced/interoperability.html">
            
                <a href="../advanced/interoperability.html">
            
                    
                    Interoperability
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Troubleshooting</li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="../troubleshooting/">
            
                <a href="../troubleshooting/">
            
                    
                    Troubleshooting
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1.1" data-path="../troubleshooting/common-gotchas.html">
            
                <a href="../troubleshooting/common-gotchas.html">
            
                    
                    Common gotchas
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.2" data-path="../troubleshooting/show-config.html">
            
                <a href="../troubleshooting/show-config.html">
            
                    
                    Diagnostics
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Architecture</li>
        
        
    
        <li class="chapter " data-level="5.1" data-path="../architecture/">
            
                <a href="../architecture/">
            
                    
                    Articles
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1.1" data-path="../architecture/green-cache.html">
            
                <a href="../architecture/green-cache.html">
            
                    
                    Green Cache
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Topology</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="default-topology-conventions">Default Topology Conventions</h1>
<p>In this example topology, two commands and events are used.</p>
<p>First, the event contracts that are supported by an endpoint that receives files from a customer.</p>
<pre class="language-"><code class="lang-csharp"><span class="token keyword">interface</span> <span class="token class-name">FileReceived</span>
<span class="token punctuation">{</span>
    Guid FileId <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    DateTime Timestamp <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    Uri Location <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">CustomerDataReceived</span>
<span class="token punctuation">{</span>
    DateTime Timestamp <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">string</span> CustomerId <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">string</span> SourceAddress <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    Uri Location <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Second, the command contract for processing a file that was received.</p>
<pre class="language-"><code class="lang-csharp"><span class="token keyword">interface</span> <span class="token class-name">ProcessFile</span>
<span class="token punctuation">{</span>
    Guid FileId <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    Uri Location <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>The above contracts are used by the consumers to receive messages. From a publishing or sending perspective, two classes are created by the event producer and the command sender which implement these interfaces.</p>
<pre class="language-"><code class="lang-csharp"><span class="token keyword">class</span> <span class="token class-name">FileReceivedEvent</span> <span class="token punctuation">:</span>
    FileReceived<span class="token punctuation">,</span>
    CustomerDataReceived
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> Guid FileId <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> DateTime Timestamp <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> Uri Location <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">string</span> CustomerId <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">string</span> SourceAddress <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>And the command class.</p>
<pre class="language-"><code class="lang-csharp"><span class="token keyword">class</span> <span class="token class-name">ProcessFileCommand</span> <span class="token punctuation">:</span>
    ProcessFile
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> Guid FileId <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>   
    <span class="token keyword">public</span> Uri Location <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>The consumers for these message contracts are as below.</p>
<pre class="language-"><code class="lang-csharp"><span class="token keyword">class</span> <span class="token class-name">FileReceivedConsumer</span> <span class="token punctuation">:</span>
    IConsumer<span class="token operator">&lt;</span>FileReceived<span class="token operator">&gt;</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">CustomerAuditConsumer</span> <span class="token punctuation">:</span>
    IConsumer<span class="token operator">&lt;</span>CustomerDataReceived<span class="token operator">&gt;</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">ProcessFileConsumer</span> <span class="token punctuation">:</span>
    IConsumer<span class="token operator">&lt;</span>ProcessFile<span class="token operator">&gt;</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="rabbitmq">RabbitMQ</h2>
<h3 id="publish">Publish</h3>
<p><img src="images/rabbitmq-publish-topology.png" alt="rabbitmq-publish-topology"></p>
<p>The event publisher, upon publishing a message, ensures that:</p>
<ul>
<li>An exchange named <code>BigBusiness.Contracts.FileReceivedEvent</code> is declared, matching the class name being published.</li>
<li>An exchange named <code>BigBusiness.Contracts.FileReceived</code> is declared, matching the interface name implemented by the <code>FileReceivedEvent</code> class.<ul>
<li>An exchange binding between the <code>BigBusiness.Contracts.FileReceivedEvent</code> exchange and the <code>BigBusiness.Contracts.FileReceived</code> exchange is declared.</li>
</ul>
</li>
<li>An exchange named <code>BigBusiness.Contracts.CustomerDataReceived</code> is declared, matching the interface name implemented by the <code>FileReceivedEvent</code> class.<ul>
<li>An exchange binding between the <code>BigBusiness.Contracts.FileReceivedEvent</code> exchange and the <code>BigBusiness.Contracts.CustomerDataReceived</code> exchange is declared.</li>
</ul>
</li>
</ul>
<p>The receive endpoint on the <code>input-queue</code>, when the bus is started, ensures that:</p>
<ul>
<li>An exchanged named <code>input-queue</code> is declared, matching the queue name.</li>
<li>A queue named <code>input-queue</code> is declared.<ul>
<li>A queue binding between the <code>input-queue</code> exchange and the <code>input-queue</code> queue is declared.</li>
</ul>
</li>
<li>An exchange named <code>BigBusiness.Contracts.FileReceived</code> is declared, matching the interface name consumed by the <code>FileReceivedConsumer</code> class.<ul>
<li>An exchange binding between the <code>BigBusiness.Contracts.FileReceived</code> exchange and the <code>input-queue</code> exchange is declared.</li>
</ul>
</li>
</ul>
<p>The receive endpoint on the <code>audit-queue</code>, when the bus is started, ensures that:</p>
<ul>
<li>An exchanged named <code>audit-queue</code> is declared, matching the queue name.</li>
<li>A queue named <code>audit-queue</code> is declared.<ul>
<li>A queue binding between the <code>audit-queue</code> exchange and the <code>audit-queue</code> queue is declared.</li>
</ul>
</li>
<li>An exchange named <code>BigBusiness.Contracts.CustomerDataReceived</code> is declared, matching the interface name consumed by the <code>CustomerAuditConsumer</code> class.<ul>
<li>An exchange binding between the <code>BigBusiness.Contracts.CustomerDataReceived</code> exchange and the <code>audit-queue</code> exchange is declared.</li>
</ul>
</li>
</ul>
<div class="alert alert-info">
<b>Note:</b>
    All declared exchanges are Fanout by default.
</div>

<div class="alert alert-info">
<b>Important!:</b>
If a message is published before bus containing the receive endpoint is started, the receive endpoint topology will not have been created. Without the consumer end of the topology, messages sent to the exchange will disappear as there are no bindings in place. If you need to guarantee the published message is delivered, consider setting `Mandatory` to true on the `RabbitMqSendContext`. This will throw an exception if a message is published and there are no exchange bindings in place.
</div>

<h3 id="send">Send</h3>
<p><img src="images/rabbitmq-send-topology.png" alt="rabbitmq-send-topology"></p>
<p>The command sender, upon sending a message, ensures that:</p>
<ul>
<li>An exchange named <code>service-queue</code> is declared, matching the name in the endpoint address.</li>
</ul>
<p>The receive endpoint on the <code>service-queue</code>, when the bus is started, ensures that:</p>
<ul>
<li>An exchanged named <code>service-queue</code> is declared, matching the queue name.</li>
<li>A queue named <code>service-queue</code> is declared.<ul>
<li>A queue binding between the <code>service-queue</code> exchange and the <code>service-queue</code> queue is declared.</li>
</ul>
</li>
<li>An exchange named <code>BigBusiness.Contracts.ProcessFile</code> is declared, matching the interface name consumed by the <code>ProcessFileConsumer</code> class.<ul>
<li>An exchange binding between the <code>BigBusiness.Contracts.ProcessFile</code> exchange and the <code>service-queue</code> exchange is declared.</li>
</ul>
</li>
</ul>
<div class="alert alert-info">
<b>Important!:</b>
The same rule for publish applies to send, if the consumer topology isn&apos;t setup by the receive endpoint, messages will disappear.
</div>

<h2 id="azure-service-bus">Azure Service Bus</h2>
<h3 id="publish">Publish</h3>
<p><img src="images/servicebus-publish-topology.png" alt="servicebus-publish-topology"></p>
<p>The event publisher, upon publishing a message, ensures that:</p>
<ul>
<li>A topic named <code>BigBusiness.Contracts.FileReceived</code> is created, matching the interface name implemented by the <code>FileReceivedEvent</code> class.</li>
<li>A topic named <code>BigBusiness.Contracts.CustomerDataReceived</code> is created, matching the interface name implemented by the <code>FileReceivedEvent</code> class.</li>
</ul>
<p>The receive endpoint on the <code>input-queue</code>, when the bus is started, ensures that:</p>
<ul>
<li>A queue named <code>input-queue</code> is created.</li>
<li>A topic named <code>BigBusiness.Contracts.FileReceived</code> is created, matching the interface name consumed by the <code>FileReceivedConsumer</code> class.<ul>
<li>A subscription on the <code>BigBusiness.Contracts.FileReceived</code> topic, which forwards to the <code>input-queue</code> queue is created.</li>
</ul>
</li>
</ul>
<p>The receive endpoint on the <code>audit-queue</code>, when the bus is started, ensures that:</p>
<ul>
<li>A queue named <code>audit-queue</code> is created.</li>
<li>A topic named <code>BigBusiness.Contracts.CustomerDataReceived</code> is created, matching the interface name consumed by the <code>CustomerAuditConsumer</code> class.<ul>
<li>A subscription on the <code>BigBusiness.Contracts.CustomerDataReceived</code> topic, which forwards to the <code>audit-queue</code> queue is created.</li>
</ul>
</li>
</ul>
<div class="alert alert-info">
<b>Important!:</b>
If a message is published before bus containing the receive endpoint is started, the receive endpoint topology will not have been created. Without the consumer end of the topology, messages sent to the exchange will disappear as there are no subscriptions in place.
</div>

<h3 id="send">Send</h3>
<p><img src="images/servicebus-send-topology.png" alt="servicebus-send-topology"></p>
<p>The command sender, upon sending a message, ensures that:</p>
<ul>
<li>A queue named <code>service-queue</code> is created, matching the name in the endpoint address.</li>
</ul>
<p>The receive endpoint on the <code>service-queue</code>, when the bus is started, ensures that:</p>
<ul>
<li>A queue named <code>service-queue</code> is created.</li>
<li>A topic named <code>BigBusiness.Contracts.ProcessFile</code> is created, matching the interface name consumed by the <code>ProcessFileConsumer</code> class.<ul>
<li>A subscription on the <code>BigBusiness.Contracts.ProcessFile</code> topic, which forwards to the <code>service-queue</code> queue is created.</li>
</ul>
</li>
</ul>
<p><div class="alert alert-info">
<b>Important!:</b>
The same rule for publish applies to send, if the consumer topology isn&apos;t setup by the receive endpoint, messages will disappear.
</div>div&gt;</p>
<h3 id="sneak-peak---publish">Sneak Peak - Publish</h3>
<p>In an upcoming release of MassTransit, the same polymorphic behavior of RabbitMQ will also be supported by Azure Service Bus, as shown below.</p>
<p><img src="images/servicebus-publish-topology-next.png" alt="servicebus-publish-topology-next"></p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="under-the-hood.html" class="navigation navigation-prev " aria-label="Previous page: Under the hood">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="additions-to-transport.html" class="navigation navigation-next " aria-label="Next page: What we add to the transport">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Topology","level":"1.2.2.1","depth":3,"next":{"title":"What we add to the transport","level":"1.2.3","depth":2,"path":"understand/additions-to-transport.md","ref":"understand/additions-to-transport.md","articles":[]},"previous":{"title":"Under the hood","level":"1.2.2","depth":2,"path":"understand/under-the-hood.md","ref":"understand/under-the-hood.md","articles":[{"title":"Topology","level":"1.2.2.1","depth":3,"path":"understand/default-topology.md","ref":"understand/default-topology.md","articles":[]}]},"dir":"ltr"},"config":{"plugins":["edit-link","prism","-highlight","github","anchorjs","expandable-chapters"],"root":"docs","styles":{"website":"build/gitbook.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"prism":{},"github":{"url":"https://github.com/MassTransit/MassTransit/"},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"edit-link":{"label":"Edit This Page","base":"https://github.com/masstransit/masstransit/tree/master/docs"},"theme-default":{"styles":{"website":"build/gitbook.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"anchorjs":{},"expandable-chapters":{}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"MassTransit","gitbook":"3.2.2"},"file":{"path":"understand/default-topology.md","mtime":"2017-03-30T16:19:59.996Z","type":"markdown"},"gitbook":{"version":"3.2.2","time":"2017-03-30T16:24:03.258Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-edit-link/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-github/plugin.js"></script>
        
    
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/3.1.1/anchor.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-anchorjs/anchor-style.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

